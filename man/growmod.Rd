% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/growmod.R
\name{growmod}
\alias{growmod}
\title{Growth Model Objective Function for Tag-Recapture Data}
\usage{
growmod(pin)
}
\arguments{
\item{pin}{Named list of model parameters to be estimated.}
}
\value{
Scalar value of total negative log-likelihood (to be minimized).
Model outputs are made available via \code{REPORT()} for later extraction with
\code{mod$rep()}.
}
\description{
Core RTMB objective function that constructs size transition matrices (STMs)
from asymmetric inverse logistic growth curves and calculates negative
log-likelihood for tag-recapture observations with measurement error.
}
\details{
This function is designed to be passed to \code{RTMB::MakeADFun()} and expects
the following objects in the calling environment:

\strong{From \code{datain} (via \code{getAll()}):}
\describe{
\item{nlbin}{Number of length bins}
\item{ntsteps}{Number of time steps (typically months) per year}
\item{goodts}{Integer vector of time steps for which to estimate growth}
\item{lbin, lbinL, lbinU}{Length bin midpoints, lower, and upper bounds}
\item{Tlbin, Clbin}{Release and recapture length bin indices}
\item{Rlcl, Rccl}{Release and recapture carapace lengths}
\item{relts}{Release time step for each observation}
\item{tsteps}{Time steps at liberty for each observation}
\item{nlob}{Number of lobsters per observation (for weighting)}
}

\strong{From \code{pin} (parameters to estimate):}
\describe{
\item{mxpin, mnpin}{Log-scale maximum and minimum growth increments by time step}
\item{ipin}{Inflection point of growth curve by time step}
\item{spin_left, spin_right}{Log-scale steepness parameters (left/right of inflection)}
\item{LsigError}{Log-scale measurement error standard deviation}
\item{sigGrow}{Log-scale growth variability}
\item{MerrorRel, MerrorRec}{Measurement error random effects (release/recapture)}
\item{LMerrorRelsigma, LMerrorRecsigma}{Log-scale random effect standard deviations}
}

\strong{Growth Model:}
Uses an asymmetric inverse logistic function with smoothly transitioning steepness:
\deqn{growth = \frac{max - min}{1 + \exp((L - inflection)/steepness)} + min}
where steepness transitions from \code{spin_left} to \code{spin_right} across the inflection point.

\strong{Likelihood:}
Kullback-Leibler divergence between predicted and observed recapture length
distributions, with penalty terms for measurement error priors and parameter
constraints.
}
\examples{
\dontrun{
# Prepare data and parameters
datain <- list(...)  # Tag-recapture data
pin <- list(...)     # Initial parameter values

# Fit model
mod <- MakeADFun(data = datain, parameters = pin,
                 map = Mapfunc(pin), DLL = "growmod")
opt <- nlminb(mod$par, mod$fn, mod$gr)
}

}
